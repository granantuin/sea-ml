
# Sea-ML

This repository offers machine learning models and tools designed to predict meteorological variables from coastal stations provided by MeteoGalicia, the regional meteorological service. It includes machine learning algorithms, primarily from the scikit-learn library, deployed through operational.py. The models are specifically trained on meteorological data collected from each station, with the directories named according to the respective station they represent.

## Directory Structure
Each directory corresponds to a coastal meteorological station from the MeteoGalicia service. These directories contain datasets, scripts, and machine learning models tailored for specific stations.

```bash
.
├── README.md                 # Project documentation (this file)
├── operational.py            # Script for running ML models based on the scikit-learn library
├── operational_global.py     # Script for running ML models based on the scikit-learn library
├── requirements.txt          # Python packages and dependencies required
├── station-name/             # Files and models related to the station-name            
   └── input_files/           # Input data files for training models for station
   └── notebooks/             # Jupyter notebooks for training and testing models for station
   └── algorithms/            # Pre-trained model files (.al) for station 
```

## Usage

### Input Files

- **station_name.csv**: A CSV file containing observed meteorological variables for a given station. This file is generated as an output from the [MeteoGalicia](https://www.meteogalicia.gal/observacion/estacions/estacions.action?request_locale=gl) data portal.

- **get_wrf_(a)k.ipynb**: A Jupyter Notebook designed to retrieve historical meteorological data from WRF (Weather Research and Forecasting) models provided by [MeteoGalicia](https://www.meteogalicia.gal/web/modelos-numericos/servidor-thredds?request_locale=gl), where `(a)` indicates the spatial resolution in kilometers (e.g., 4 km or 1 km). This notebook fetches data that is used for model training and analysis.

- **distan_lat(a)_lon(b)_p(c)_R(d)Km.csv**: A CSV file that lists the coordinates of the `c` nearest WRF model grid points to a specific station, identified by its latitude `(a)` and longitude `(b)`. The file also includes the distance `(d)` in kilometers between each model grid point and the station. This file is generated by the `get_wrf_4k.ipynb` notebook.

- **lat(a)_lon(b)_p(c)_R(d)Km.kml**: A KML (Keyhole Markup Language) file containing the geospatial data from the corresponding CSV file. It visualizes the WRF model grid points around the station, making it easy to view in GIS tools such as Google Earth. This file is an output from the `get_wrf_(a)k.ipynb` notebook.

- **lat(a)_lon(b)_p(c)_R(d)Km_D(e)_Y(f).csv**: A CSV file containing forecasted meteorological variables from the WRF model, with a forecast range of `Day (e)` for the year `Y(f)`. The variables are organized based on proximity to the station: variables with the subindex `0` correspond to the nearest grid point to the station’s coordinates `(a, b)`, and subsequent subindices represent increasingly distant grid points. The distance between forecasted points is denoted by `(d)`. This file is produced by the `get_wrf_(a)k.ipynb` notebook.

### Notebooks

The Jupyter notebooks in this repository are used for training and saving machine learning models for individual meteorological variables at specific coastal stations.

#### Meteorological Variable Models

Each station has a set of notebooks for training machine learning models tailored to individual meteorological variables. These notebooks are located in the respective station directories (e.g., `coron/notebooks/`). Each notebook is specific to both the station and the meteorological variable, and it includes all the necessary steps for preprocessing the data, training the model, evaluating its performance, and saving it.

The files follow a naming convention: `variable_code_<station-name>_d<x>`. Occasionally, the filenames include a forecast range, such as `d0`, `d1`, etc., indicating the forecast scope of the model:
- **d0**: Forecasts from H00 to H24.
- **d1**: Forecasts from H24 to H48.

#### Variable Code List:

| Variable Code | Description                                |
| ------------- | ------------------------------------------ |
| **dir**       | Wind direction (average of 1 hour before)   |
| **spd**       | Wind speed (average of 1 hour before)       |
| **gust**      | Wind gust (maximum 1 hour before)           |
| **rdir**      | Wind direction (average of 10 minutes before)|
| **sddir**     | Wind direction standard deviation (10 minutes before) |
| **rspd**      | Wind speed (average of 10 minutes before)   |
| **sdspd**     | Wind speed standard deviation (10 minutes before) |
| **prec**      | Precipitation accumulation (total 1 hour before)                            |

#### Training a Model

1. Navigate to the notebook directory for the desired station (e.g., `coron/notebooks/`).
2. Open the relevant notebook in Jupyter Notebook or JupyterLab.
3. Follow the steps in the notebook to:
   - Preprocess the data.
   - Train the machine learning model.
   - Save the trained model to the `algorithms/` directory.









